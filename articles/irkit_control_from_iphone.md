---
title: "å»¶å‘½ã—ãŸIRKitã‚’iPhoneã‹ã‚‰æ“ä½œã™ã‚‹"
emoji: "ðŸ“±"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["irkit", "iot"]
published: false
---

https://zenn.dev/articles/irkit_install_custom_firmware ã®ç¶šãã§ã€åŒã˜Wifiã«æŽ¥ç¶šã—ãŸiPhoneã‹ã‚‰IRKitã‚’æ“ä½œã™ã‚‹æ‰‹é †ã§ã™ã€‚

## ç›®çš„

https://zenn.dev/articles/irkit_install_custom_firmware ã®è¨˜äº‹ã§IRKitã‚’å»¶å‘½ã§ãã¾ã—ãŸã€‚
ãã‚‚ãã‚‚è‡ªåˆ†ãŒIRKitã‚’ä½¿ã£ã¦ã„ã‚‹ç›®çš„ã¯ã€å†¬ã®æœã«èµ·ãã‚‹ã®ãŒè¾›ã„ã®ã§ã€è‡ªåˆ†ãŒèµ·ãã‚‹æ™‚é–“ã‚ˆã‚Šã¡ã‚‡ã£ã¨æ—©ãã‚¨ã‚¢ã‚³ãƒ³ã‚’ã¤ã‘ãŸã„ã¨ã„ã†ã‚‚ã®ã§ã—ãŸã€‚
ã‚¨ã‚¢ã‚³ãƒ³ã«ã‚‚ã‚¿ã‚¤ãƒžãƒ¼ã¯ã‚ã‚Šã¾ã™ãŒã€ä½¿ã„ã¥ã‚‰ã„ã®ã§ã€‚

ä»Šå›žã¯å»¶å‘½ã—ãŸIRKitã‚’ä½¿ç”¨ã—ã€iPhoneã‹ã‚‰æ“ä½œã§ãã‚‹ã¨ã“ã‚ã¾ã§ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## ç’°å¢ƒ

- Macbook Air 2020 (Apple M1)
- macOS: Ventura 13.1

## æº–å‚™ã™ã‚‹ã‚‚ã®

- IRKitï¼ˆå»¶å‘½æ¸ˆã¿ï¼‰
- USB Micro-Bã‚±ãƒ¼ãƒ–ãƒ«

## æ‰‹é †

### IRKitã®ãƒ›ã‚¹ãƒˆåã‚’å–å¾—

IRKitã®ãƒ›ã‚¹ãƒˆåã‚’å–å¾—ã—ã¾ã™ã€‚
IRKitãŒWifiã«æŽ¥ç¶šã•ã‚ŒãŸçŠ¶æ…‹ã«ã—ã¾ã™ã€‚

macã§ã‚ã‚Œã°ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰ `dns-sd` ã‚³ãƒžãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ï¼ˆLinuxãªã‚‰ `avahi-browse _irkit._tcp` ã§åŒç­‰ã®ã“ã¨ãŒã§ãã‚‹ã¯ãšï¼‰

```shell
$ dns-sd -B _irkit._tcp
Browsing for _irkit._tcp
DATE: ---Wed 28 Dec 2022---
20:40:34.883  ...STARTING...
Timestamp     A/R    Flags  if Domain               Service Type         Instance Name
20:40:35.145  Add        2  12 local.               _irkit._tcp.         iRKit8044
```

è‡ªåˆ†ã®ã¨ã“ã‚ã§ã¯IRKit `iRKit8044` ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚ã“ã®å ´åˆã€ãƒ›ã‚¹ãƒˆåã¯ `irkit8044.local` ã«ãªã‚Šã¾ã™ã€‚

### ãƒªãƒ¢ã‚³ãƒ³ã®èµ¤å¤–ç·šæƒ…å ±ã‚’èª­ã¿å‡ºã—

IRKitã‚’ä½¿ç”¨ã—ã¦ã‚¨ã‚¢ã‚³ãƒ³ã®èµ¤å¤–ç·šæƒ…å ±ã‚’èª­ã¿å‡ºã—ã¾ã™ã€‚ 

ã‚¨ã‚¢ã‚³ãƒ³ã®ãƒªãƒ¢ã‚³ãƒ³ã‚’IRKitã®å‰æ–¹ã«ã‚ã‚‹é€æ˜Žã®LEDã«å‘ã‘ã€é‹è»¢ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚
ãã®å¾Œã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰ä»¥ä¸‹ã®ã‚³ãƒžãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
ãƒ›ã‚¹ãƒˆåã¯å„è‡ªå¤‰æ›´ã—ã¦ãã ã•ã„ã€‚

```shell
$ curl 'http://irkit8044.local/messages' -H 'X-Requested-With: curl' -v
*   Trying 192.168.1.179:80...
* Connected to irkit8044.local (192.168.1.179) port 80 (#0)
> GET /messages HTTP/1.1
> Host: irkit8044.local
> User-Agent: curl/7.85.0
> Accept: */*
> X-Requested-With: curl
>
* Mark bundle as not supporting multiuse
* HTTP 1.0, assume close after body
< HTTP/1.0 200 OK
< Access-Control-Allow-Origin: *
< Server: IRKit/3.0.0.0.g85190b1
< Content-Type: text/plain
<
* Closing connection 0
{"format":"raw","freq":38,"data":[8755,8755,1190,3119,1190,3119,1190,3119,1190,3119,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,935,1190,935,1190,935,1190,3119,1190,3119,1190,935,1190,3119,1190,935,1190,935,1190,935,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,3119,1190,3119,1190,3119,1190,3119,1190,3119,1190,935,1190,3119,1190,3119,1190,935,1190,935,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,3119,1190,3119,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,935,1190,3119,1190,3119,1190,935,1190,3119,1190,3119,1190,10047,8755,8755,1190,3119,1190,3119,1190,3119,1190,3119,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,935,1190,935,1190,935,1190,3119,1190,3119,1190,935,1190,3119,1190,935,1190,935,1190,935,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,3119,1190,3119,1190,3119,1190,3119,1190,3119,1190,935,1190,3119,1190,3119,1190,935,1190,935,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,3119,1190,3119,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,935,1190,3119,1190,935,1190,935,1190,935,1190,3119,1190,3119,1190,935,1190,3119,1190,3119,1190]}%
```

ä¸­æ‹¬å¼§ã§å›²ã¾ã‚ŒãŸéƒ¨åˆ†ãŒé€ä¿¡ã™ã‚‹ãƒªãƒ¢ã‚³ãƒ³ã®èµ¤å¤–ç·šæƒ…å ±ã§ã™ã€‚
ã‚ã¨ã§ä½¿ã†ã®ã§ãƒ¡ãƒ¢ã—ã¦ãŠãã¾ã™ã€‚

### ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚¢ãƒ—ãƒªã‚’èµ·å‹•

iPhoneã‹ã‚‰æ“ä½œã™ã‚‹éš›ã«ã¯ã€ã€Œã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã€ã‚¢ãƒ—ãƒªã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
ã€Œã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã€ã‚¢ãƒ—ãƒªã¯iCloudã§é€£æºãŒã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€macã§ä½œæˆã—ãŸã‚‚ã®ãŒiPhoneã«é€£æºã•ã‚Œã¾ã™ã€‚
ä»Šå›žã¯macã§ä½œæˆã—ã¾ã™ã€‚

### ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚’ä½œæˆ

ã€Œãƒ•ã‚¡ã‚¤ãƒ«â†’æ–°è¦ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚’ä½œæˆã€ã§æ–°ã—ã„ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/84e8658b8c61-20221228.png)

#### ã€Œãƒ†ã‚­ã‚¹ãƒˆã€ã‚’ä½œæˆ

ç”»é¢å³å´ã®æ¤œç´¢ãƒãƒ¼ã«ã€Œãƒ†ã‚­ã‚¹ãƒˆã€ã¨å…¥åŠ›ã—ã¾ã™ã€‚
æ¤œç´¢çµæžœã‹ã‚‰ã€Œãƒ†ã‚­ã‚¹ãƒˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ç”»é¢å·¦å´ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
ãƒ†ã‚­ã‚¹ãƒˆã®ä¸­èº«ã«å…ˆã»ã©ã®ãƒªãƒ¢ã‚³ãƒ³ã®èµ¤å¤–ç·šæƒ…å ±ã‚’ã‚³ãƒ”ãƒšã—ã¾ã™ã€‚ãã®éš›ã€ä¸­æ‹¬å¼§ã‚’ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆ (`''`)ã§å›²ã„ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/b15688f18b03-20221228.png)

#### ã€ŒURLã®å†…å®¹ã‚’å–å¾—ã€ã‚’ä½œæˆ

ç”»é¢å³å´ã®æ¤œç´¢ãƒãƒ¼ã«ã€ŒURLã€ã¨å…¥åŠ›ã—ã¾ã™ã€‚
æ¤œç´¢çµæžœã‹ã‚‰ã€ŒURLã®å†…å®¹ã‚’å–å¾—ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ç”»é¢å·¦å´ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
ä»¥ä¸‹ã®é€šã‚Šå…¥åŠ›ã—ã¾ã™ã€‚

- URL: `http://irkit8044.local/messages` (ãƒ›ã‚¹ãƒˆåã¯å„è‡ªå¤‰æ›´ã—ã¦ãã ã•ã„)
- ãƒ˜ãƒƒãƒ€
  - ã‚­ãƒ¼: `X-Requested-With`
  - å€¤: `curl`
- æœ¬æ–‡ã‚’è¦æ±‚: `ãƒ•ã‚¡ã‚¤ãƒ«`
- ãƒ•ã‚¡ã‚¤ãƒ«; `ãƒ†ã‚­ã‚¹ãƒˆ`

![](https://storage.googleapis.com/zenn-user-upload/ed291bdceda3-20221228.png)

### ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã®ãƒ†ã‚¹ãƒˆ

ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚’ä½œæˆã—ãŸã‚‰ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚
å†ç”Ÿãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€ã‚¨ã‚¢ã‚³ãƒ³ãŒONã«ãªã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/1fe5d00f6ddd-20221228.png)

### åå‰ã‚„ã‚¢ã‚¤ã‚³ãƒ³ã®å¤‰æ›´

ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ã‚‹ã¨ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚
![](https://storage.googleapis.com/zenn-user-upload/6f7c09e85db8-20221228.png)

åå‰ã‚„ã‚¢ã‚¤ã‚³ãƒ³ã¯ä½œæˆã—ãŸã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚’å³ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã“ã¨ã§å¤‰æ›´ã§ãã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/8a29b7009d87-20221228.png)

## ã¾ã¨ã‚

iPhoneã‹ã‚‰IRKitã‚’æ“ä½œã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚

